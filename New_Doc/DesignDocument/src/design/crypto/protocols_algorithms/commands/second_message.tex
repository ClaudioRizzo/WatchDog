\paragraph{Second message}\hspace{0pt}\\
When the first message is recived and validated (signature, header) the receiver stores the iv and generates the key starting from the common secret and the salt; then he generates and stores an initialization vector for the encryption/decryption of m4 and generates also a salt used immediately to generate the m4 encryption/decryption key, which is saved in the preferences; now m2 is constructed with those elements in the same way m1 was (header + iv + salt + ecdsa signature), and sent to the other. After that a 120 seconds timeout is started and the command session log is updated.